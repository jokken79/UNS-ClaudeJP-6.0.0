# SISTEMA DE FACTORIES - DISEÃ‘O MEJORADO

**Fecha:** 2025-11-13  
**VersiÃ³n:** 1.0  
**Autor:** Claude Code Architecture Analysis

---

## ğŸ“‹ RESUMEN EJECUTIVO

**Problema Actual:**
- Factory structure no refleja jerarquÃ­a real: Company â†’ Plants â†’ Lines
- Employees asignados a `factory_id` (plant level) sin ver company/line
- No UI para gestionar factories de forma jerÃ¡rquica
- No dropdowns en cascada en å…¥ç¤¾é€£çµ¡ç¥¨ (Employee Assignment Form)
- Timer cards no usan config de factory para calcular overtime

**SoluciÃ³n Propuesta:**
- UI jerÃ¡rquica con tree view: Company â†’ Plants â†’ Lines
- Cascading dropdowns en asignaciÃ³n de employees
- Factory config editor para schedule/payment rules
- Integration con Timer Cards para calcular overtime/breaks automÃ¡ticamente

---

## 1. ANÃLISIS DE ESTRUCTURA ACTUAL

### 1.1 Estructura JSON Actual

```json
{
  "factory_id": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´",  // Company_Plant
  "client_company": {
    "name": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾",              // Company Name
    "address": "æ„›çŸ¥çœŒå¼¥å¯Œå¸‚...",
    "phone": "0567-68-8110",
    "responsible_person": {...},
    "complaint_handler": {...}
  },
  "plant": {
    "name": "æœ¬ç¤¾å·¥å ´",                      // Plant Name
    "address": "æ„›çŸ¥çœŒå¼¥å¯Œå¸‚...",
    "phone": "0567-68-8110"
  },
  "lines": [                                 // Lines (Work Areas)
    {
      "line_id": "Factory-39",
      "assignment": {
        "department": "ç¬¬ä¸€å–¶æ¥­éƒ¨æœ¬ç¤¾å–¶æ¥­èª²",
        "line": "ãƒªãƒ•ãƒˆä½œæ¥­",               // Line Name
        "supervisor": {...}
      },
      "job": {
        "description": "é‹³é€ ææ–™ã®ä¾›çµ¦",
        "hourly_rate": 1750.0                // Line-specific rate
      }
    }
  ],
  "schedule": {
    "work_hours": "7:00ï½15:30 / 19:00ï½3:30",
    "break_time": "11:00ï½11:45 (45åˆ†)",
    "overtime_labor": "3h/æ—¥, 42h/æœˆ",
    "time_unit": "15.0"                      // Rounding unit (15 min)
  },
  "payment": {
    "closing_date": "15æ—¥",
    "payment_date": "å½“æœˆæœ«æ—¥"
  }
}
```

### 1.2 JerarquÃ­a Real de Factories

**AnÃ¡lisis de datos actuales:**

```
ğŸ“Š TOTAL: 14 Companies, 24 Plants, 150+ Lines

Companies con mÃºltiples plants:
â”œâ”€ é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾ (9 plants)
â”‚  â”œâ”€ æœ¬ç¤¾å·¥å ´ (8 lines)
â”‚  â”œâ”€ CVJå·¥å ´ (8 lines)
â”‚  â”œâ”€ HUBå·¥å ´
â”‚  â”œâ”€ æµ·å—ç¬¬ä¸€å·¥å ´
â”‚  â”œâ”€ æµ·å—ç¬¬äºŒå·¥å ´
â”‚  â”œâ”€ å²¡å±±å·¥å ´
â”‚  â”œâ”€ é™å²¡å·¥å ´
â”‚  â”œâ”€ ç¬¬ä¸€å·¥å ´
â”‚  â””â”€ ç¬¬äºŒå·¥å ´
â”‚
â”œâ”€ ãƒ¦ã‚¢ã‚µå·¥æ©Ÿæ ªå¼ä¼šç¤¾ (2 plants)
â”‚  â”œâ”€ æœ¬ç¤¾å·¥å ´
â”‚  â””â”€ æ–°åŸå·¥å ´
â”‚
â””â”€ åŠ è—¤æœ¨æå·¥æ¥­æ ªå¼ä¼šç¤¾ (2 plants)
   â”œâ”€ æœ¬ç¤¾å·¥å ´ (10 lines)
   â””â”€ æ˜¥æ—¥äº•å·¥å ´

Companies con 1 solo plant:
â”œâ”€ ç‘é™µç²¾æ©Ÿæ ªå¼ä¼šç¤¾ â†’ æµé‚£å·¥å ´
â”œâ”€ æ ªå¼ä¼šç¤¾å·åŸé‰„å·¥æ‰€ â†’ æœ¬ç¤¾å·¥å ´
â”œâ”€ ãƒ•ã‚§ãƒ‹ãƒ†ãƒƒã‚¯ã‚»ãƒŸã‚³ãƒ³ãƒ€ã‚¯ã‚¿ãƒ¼(æ ª) â†’ é¹¿å…å³¶å·¥å ´
â”œâ”€ ã‚»ã‚¤ãƒ“ãƒ†ãƒƒã‚¯æ ªå¼ä¼šç¤¾
â”œâ”€ å…­ç”²é›»å­æ ªå¼ä¼šç¤¾ â†’ æœ¬ç¤¾å·¥å ´
â”œâ”€ æ ªå¼ä¼šç¤¾ç¾éˆ´å·¥æ¥­ â†’ æœ¬ç¤¾å·¥å ´
â”œâ”€ æ ªå¼ä¼šç¤¾ã‚ªãƒ¼ãƒ„ã‚« â†’ é–¢ã‚±åŸå·¥å ´
â”œâ”€ ä¸‰å¹¸æŠ€ç ”æ ªå¼ä¼šç¤¾ â†’ æœ¬ç¤¾å·¥å ´
â”œâ”€ ã‚¢ã‚µãƒ’ãƒ•ã‚©ãƒ¼ã‚¸æ ªå¼ä¼šç¤¾ â†’ çœŸåº­å·¥å ´
â”œâ”€ ãƒ”ãƒ¼ã‚¨ãƒ ã‚¢ã‚¤æœ‰é™ä¼šç¤¾ â†’ æœ¬ç¤¾å·¥å ´
â””â”€ ãƒ†ã‚£ãƒ¼ã‚±ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°æ ªå¼ä¼šç¤¾ â†’ æµ·å—ç¬¬äºŒå·¥å ´
```

---

## 2. UI JERÃRQUICA - TREE VIEW

### 2.1 Vista Principal: /dashboard/factories

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ­ Factory Management                                [+ Add Company]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  ğŸ” [Search companies, plants, lines...]               [â†“ Import JSON]  â”‚
â”‚                                                         [â†‘ Export JSON]  â”‚
â”‚                                                                           â”‚
â”‚  ğŸ“Š Summary: 14 companies â€¢ 24 plants â€¢ 150+ lines                       â”‚
â”‚                                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ¢ Companies                                                     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â–¼ ğŸ­ é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾                              [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     ğŸ“ æ„›çŸ¥çœŒå¼¥å¯Œå¸‚æ¥ ä¸‰ä¸ç›®13ç•ªåœ°2                              â”‚   â”‚
â”‚  â”‚     ğŸ“ 0567-68-8110                                              â”‚   â”‚
â”‚  â”‚     ğŸ­ 9 plants â€¢ 45+ lines                                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¼ ğŸ­ æœ¬ç¤¾å·¥å ´                                 [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”‚   ğŸ“ æ„›çŸ¥çœŒå¼¥å¯Œå¸‚æ¥ ä¸‰ä¸ç›®13ç•ªåœ°2                          â”‚   â”‚
â”‚  â”‚     â”‚   ğŸ“Š 8 lines â€¢ Schedule: 7:00-15:30 / 19:00-3:30          â”‚   â”‚
â”‚  â”‚     â”‚   ğŸ’´ Closing: 15æ—¥ â€¢ Payment: å½“æœˆæœ«æ—¥                    â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ ãƒªãƒ•ãƒˆä½œæ¥­                [Â¥1750/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â”‚   ğŸ‘¤ Supervisor: ä¿‚é•· å‚ä¸Š èˆ                         â”‚   â”‚
â”‚  â”‚     â”‚   â”‚   ğŸ“ é‹³é€ ææ–™ã®å·¥å ´å†…åŠ å·¥ãƒ©ã‚¤ãƒ³ã¸ã®ä¾›çµ¦              â”‚   â”‚
â”‚  â”‚     â”‚   â”‚                                                        â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ Aãƒ©ã‚¤ãƒ³                  [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â”‚   ğŸ‘¤ Supervisor: ä¿‚é•· å±±æœ¬ çµ‹å¹³                       â”‚   â”‚
â”‚  â”‚     â”‚   â”‚   ğŸ“ CVJãƒ¡ã‚¹å‹ç•ªã®æ–½å‰ŠåŠ å·¥                           â”‚   â”‚
â”‚  â”‚     â”‚   â”‚                                                        â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ Tãƒ©ã‚¤ãƒ³                  [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ ãƒãƒªå–ã‚Š                 [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ åˆ‡ç´›å›å                 [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ Fãƒ©ã‚¤ãƒ³                  [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â”œâ”€ ğŸ”§ å…­é¢åŠ å·¥                 [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚   â””â”€ ğŸ”§ Gãƒ©ã‚¤ãƒ³                  [Â¥1650/h] [Edit] [â‹®]   â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ CVJå·¥å ´                                 [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”‚   ğŸ“Š 8 lines                                               â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ HUBå·¥å ´                                 [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ æµ·å—ç¬¬ä¸€å·¥å ´                            [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ æµ·å—ç¬¬äºŒå·¥å ´                            [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ å²¡å±±å·¥å ´                                [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ é™å²¡å·¥å ´                                [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ ç¬¬ä¸€å·¥å ´                                [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â””â”€ â–¶ ğŸ­ ç¬¬äºŒå·¥å ´                                [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â–¼ ğŸ­ åŠ è—¤æœ¨æå·¥æ¥­æ ªå¼ä¼šç¤¾                          [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     ğŸ“ æ„›çŸ¥çœŒæ˜¥æ—¥äº•å¸‚æ–°é–‹ç”ºå­—å¹³æ¸•6                              â”‚   â”‚
â”‚  â”‚     ğŸ“ 0568-36-2931                                              â”‚   â”‚
â”‚  â”‚     ğŸ­ 2 plants â€¢ 20+ lines                                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚     â”œâ”€ â–¶ ğŸ­ æœ¬ç¤¾å·¥å ´                                 [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     â”‚   ğŸ“Š 10 lines                                              â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â””â”€ â–¶ ğŸ­ æ˜¥æ—¥äº•å·¥å ´                               [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚         ğŸ“Š 10 lines                                              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â–¶ ğŸ­ ãƒ¦ã‚¢ã‚µå·¥æ©Ÿæ ªå¼ä¼šç¤¾                            [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     ğŸ­ 2 plants                                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â–¶ ğŸ­ ç‘é™µç²¾æ©Ÿæ ªå¼ä¼šç¤¾                              [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚     ğŸ­ 1 plant                                                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â–¶ ğŸ­ æ ªå¼ä¼šç¤¾å·åŸé‰„å·¥æ‰€                            [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚  â–¶ ğŸ­ ãƒ•ã‚§ãƒ‹ãƒ†ãƒƒã‚¯ã‚»ãƒŸã‚³ãƒ³ãƒ€ã‚¯ã‚¿ãƒ¼(æ ª)             [Edit] [â‹®] â”‚   â”‚
â”‚  â”‚  ... (show 10 more companies)                                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                           â”‚
â”‚  [1] [2] [3] ... [5]  Showing 1-10 of 14 companies                      â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Interacciones:**
- â–¶/â–¼ Click to expand/collapse
- [Edit] Opens edit modal for company/plant/line
- [â‹®] More actions: Delete, Duplicate, View Details, Export
- [+ Add Company] Creates new company
- Drag & drop to reorder (future enhancement)

---

## 3. FORMULARIOS DE GESTIÃ“N

### 3.1 Add/Edit Company Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¢ Add New Company                                 [âœ• Close]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Company Information                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Company Name *                                           â”‚    â”‚
â”‚  â”‚ [é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_________________________]              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Address *                                                â”‚    â”‚
â”‚  â”‚ [æ„›çŸ¥çœŒå¼¥å¯Œå¸‚æ¥ ä¸‰ä¸ç›®13ç•ªåœ°2_______________]              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Phone *              â”‚  â”‚ Fax                          â”‚    â”‚
â”‚  â”‚ [0567-68-8110_____] â”‚  â”‚ [0567-68-8111____________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  Responsible Person                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Department *         â”‚  â”‚ Name *                       â”‚    â”‚
â”‚  â”‚ [æ„›çŸ¥äº‹æ¥­æ‰€_______] â”‚  â”‚ [éƒ¨é•·ã€€å®‰è—¤ã€€å¿_________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ Phone *              â”‚                                        â”‚
â”‚  â”‚ [0567-68-8110_____] â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”‚  Complaint Handler                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Department *         â”‚  â”‚ Name *                       â”‚    â”‚
â”‚  â”‚ [äººäº‹åºƒå ±ç®¡ç†éƒ¨___] â”‚  â”‚ [éƒ¨é•·ã€€å±±ç”°ã€€èŒ‚_________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ Phone *              â”‚                                        â”‚
â”‚  â”‚ [0567-68-8110_____] â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          [Cancel]  [Save Company] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Add/Edit Plant Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ­ Add Plant to é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾                  [âœ• Close]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Plant Information                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Plant Name *                                             â”‚    â”‚
â”‚  â”‚ [æœ¬ç¤¾å·¥å ´________________________________]                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Address *                                                â”‚    â”‚
â”‚  â”‚ [æ„›çŸ¥çœŒå¼¥å¯Œå¸‚æ¥ ä¸‰ä¸ç›®13ç•ªåœ°2_______________]              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Phone *              â”‚  â”‚ Fax                          â”‚    â”‚
â”‚  â”‚ [0567-68-8110_____] â”‚  â”‚ [0567-68-8111____________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“… Work Schedule                                                 â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Work Hours *                                             â”‚    â”‚
â”‚  â”‚ [æ˜¼å‹¤ï¼š7:00ï½15:30ã€€å¤œå‹¤ï¼š19:00ï½3:30________]          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Break Time *                                             â”‚    â”‚
â”‚  â”‚ [æ˜¼å‹¤ï¼š11:00ï½11:45 å¤œå‹¤ï¼š23:00ï½23:45 (45åˆ†)___]       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Time Unit (minutes)* â”‚  â”‚ Overtime Limit              â”‚    â”‚
â”‚  â”‚ [15__] min           â”‚  â”‚ [3h/æ—¥, 42h/æœˆ, 320h/å¹´___] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Calendar / Holidays                                      â”‚    â”‚
â”‚  â”‚ [æœˆï½é‡‘ (ã‚·ãƒ•ãƒˆã«æº–ãšã‚‹)                                 â”‚    â”‚
â”‚  â”‚  åœŸæ—¥ä¼‘ â€¢ å¹´æœ«å¹´å§‹ â€¢ GW â€¢ å¤å­£ä¼‘æš‡________________]     â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ’´ Payment Settings                                              â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Closing Date *       â”‚  â”‚ Payment Date *               â”‚    â”‚
â”‚  â”‚ [15_] æ—¥             â”‚  â”‚ [å½“æœˆæœ«æ—¥________________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Bank Account                                             â”‚    â”‚
â”‚  â”‚ [æ„›çŸ¥éŠ€è¡Œã€€å½“çŸ¥æ”¯åº—ã€€æ™®é€š2075479_______________]         â”‚    â”‚
â”‚  â”‚ [åç¾©äººã€€ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ä¼ç”»ï¼ˆæ ªï¼‰_________________]       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ‘¥ Worker Settings (for Employee Payroll)                       â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Closing Date *       â”‚  â”‚ Payment Date *               â”‚    â”‚
â”‚  â”‚ [15_] æ—¥             â”‚  â”‚ [15_] æ—¥                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Worker Calendar / Holidays                               â”‚    â”‚
â”‚  â”‚ [åœŸæ—¥ä¼‘ â€¢ å¹´æœ«å¹´å§‹ â€¢ GW â€¢ å¤å­£ä¼‘æš‡_______________]      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             [Cancel]  [Save Plant] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Add/Edit Line Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”§ Add Line to æœ¬ç¤¾å·¥å ´                           [âœ• Close]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Line Information                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Line ID * (Auto-generated)                               â”‚    â”‚
â”‚  â”‚ [Factory-39] (read-only)                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Department *         â”‚  â”‚ Line Name *                  â”‚    â”‚
â”‚  â”‚ [ç¬¬ä¸€å–¶æ¥­éƒ¨_______] â”‚  â”‚ [ãƒªãƒ•ãƒˆä½œæ¥­_____________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ‘¤ Supervisor Information                                        â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Department           â”‚  â”‚ Name *                       â”‚    â”‚
â”‚  â”‚ [________________]   â”‚  â”‚ [ä¿‚é•·ã€€å‚ä¸Šã€€èˆ_________] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ Phone *              â”‚                                        â”‚
â”‚  â”‚ [0567-68-8110_____] â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                   â”‚
â”‚  ğŸ’¼ Job Details                                                   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Job Description *                                        â”‚    â”‚
â”‚  â”‚ [é‹³é€ ææ–™ã®å·¥å ´å†…åŠ å·¥ãƒ©ã‚¤ãƒ³ã¸ã®ä¾›çµ¦____________]         â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Additional Description                                   â”‚    â”‚
â”‚  â”‚ [_____________________________________________]           â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ Hourly Rate * (Â¥)    â”‚                                        â”‚
â”‚  â”‚ [1750__] Â¥/hour      â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”‚  â„¹ï¸ This rate will be auto-filled when assigning employees      â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                               [Cancel]  [Save Line] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. INTEGRACIÃ“N CON å…¥ç¤¾é€£çµ¡ç¥¨ (EMPLOYEE ASSIGNMENT FORM)

### 4.1 Cascading Dropdowns Mockup

**PÃ¡gina:** `/dashboard/employees/[id]/assign-factory`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ Assign Factory - Employee: ç”°ä¸­ å¤ªéƒ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ğŸ­ Factory Assignment                                            â”‚
â”‚                                                                   â”‚
â”‚  Step 1: Select Company                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Company *                                              â–¼ â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ [Select a company...]                               â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾                                 â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ æ„›çŸ¥çœŒå¼¥å¯Œå¸‚ â€¢ 9 plants                       â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ åŠ è—¤æœ¨æå·¥æ¥­æ ªå¼ä¼šç¤¾                             â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ æ„›çŸ¥çœŒæ˜¥æ—¥äº•å¸‚ â€¢ 2 plants                     â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ ãƒ¦ã‚¢ã‚µå·¥æ©Ÿæ ªå¼ä¼šç¤¾                               â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ æ„›çŸ¥çœŒ â€¢ 2 plants                              â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ... (11 more)                                       â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  Step 2: Select Plant (disabled until company selected)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Plant *                                                â–¼ â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ [Select a plant...]                                 â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  Step 3: Select Line (disabled until plant selected)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Line *                                                 â–¼ â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ [Select a line...]                                  â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Hourly Rate (auto-filled from line)                     â”‚    â”‚
â”‚  â”‚ [____] Â¥/hour (disabled)                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             [Cancel]  [Assign]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Flujo de SelecciÃ³n (Ejemplo)

**User selects: é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: Select Plant                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Plant *                                                â–¼ â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ [Select a plant...]                                 â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ æœ¬ç¤¾å·¥å ´                                          â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ æ„›çŸ¥çœŒå¼¥å¯Œå¸‚ â€¢ 8 lines                        â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ CVJå·¥å ´                                           â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ å²¡å±±çœŒå²¡å±±å¸‚ â€¢ 8 lines                        â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ HUBå·¥å ´                                           â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ æµ·å—ç¬¬ä¸€å·¥å ´                                      â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ æµ·å—ç¬¬äºŒå·¥å ´                                      â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ å²¡å±±å·¥å ´                                          â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ é™å²¡å·¥å ´                                          â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ ç¬¬ä¸€å·¥å ´                                          â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ­ ç¬¬äºŒå·¥å ´                                          â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**User selects: æœ¬ç¤¾å·¥å ´**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: Select Line                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Line *                                                 â–¼ â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ [Select a line...]                                  â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ ãƒªãƒ•ãƒˆä½œæ¥­                                       â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ‘¤ ä¿‚é•· å‚ä¸Š èˆ â€¢ Â¥1750/h                       â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ é‹³é€ ææ–™ã®å·¥å ´å†…åŠ å·¥ãƒ©ã‚¤ãƒ³ã¸ã®ä¾›çµ¦           â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ Aãƒ©ã‚¤ãƒ³                                          â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ‘¤ ä¿‚é•· å±±æœ¬ çµ‹å¹³ â€¢ Â¥1650/h                     â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ“ CVJãƒ¡ã‚¹å‹ç•ªã®æ–½å‰ŠåŠ å·¥                         â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ Tãƒ©ã‚¤ãƒ³                                          â”‚ â”‚    â”‚
â”‚  â”‚ â”‚    ğŸ‘¤ ä¿‚é•· å±±æœ¬ çµ‹å¹³ â€¢ Â¥1650/h                     â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ ãƒãƒªå–ã‚Š        (Â¥1650/h)                        â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ åˆ‡ç´›å›å        (Â¥1650/h)                        â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ Fãƒ©ã‚¤ãƒ³         (Â¥1650/h)                        â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ å…­é¢åŠ å·¥        (Â¥1650/h)                        â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”§ Gãƒ©ã‚¤ãƒ³         (Â¥1650/h)                        â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**User selects: ãƒªãƒ•ãƒˆä½œæ¥­**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Hourly Rate (auto-filled from line)                     â”‚    â”‚
â”‚  â”‚ [1750] Â¥/hour âœ“ Auto-filled                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â„¹ï¸ This rate can be adjusted if needed for this employee       â”‚
â”‚                                                                   â”‚
â”‚  âœ… Assignment Preview:                                           â”‚
â”‚     Company: é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾                                    â”‚
â”‚     Plant:   æœ¬ç¤¾å·¥å ´                                            â”‚
â”‚     Line:    ãƒªãƒ•ãƒˆä½œæ¥­                                          â”‚
â”‚     Rate:    Â¥1,750/hour                                          â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             [Cancel]  [Assign âœ“]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Backend API para Cascading Dropdowns

**Nuevos endpoints necesarios:**

```python
# GET /api/factories/companies
# Returns list of all companies
[
  {
    "company_name": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾",
    "address": "æ„›çŸ¥çœŒå¼¥å¯Œå¸‚...",
    "phone": "0567-68-8110",
    "plant_count": 9,
    "line_count": 45
  },
  ...
]

# GET /api/factories/companies/{company_name}/plants
# Returns list of plants for a company
[
  {
    "factory_id": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´",
    "plant_name": "æœ¬ç¤¾å·¥å ´",
    "address": "æ„›çŸ¥çœŒå¼¥å¯Œå¸‚...",
    "phone": "0567-68-8110",
    "line_count": 8
  },
  ...
]

# GET /api/factories/{factory_id}/lines
# Returns list of lines for a plant
[
  {
    "line_id": "Factory-39",
    "department": "ç¬¬ä¸€å–¶æ¥­éƒ¨æœ¬ç¤¾å–¶æ¥­èª²",
    "line": "ãƒªãƒ•ãƒˆä½œæ¥­",
    "supervisor": {
      "name": "ä¿‚é•· å‚ä¸Š èˆ",
      "phone": "0567-68-8110"
    },
    "job": {
      "description": "é‹³é€ ææ–™ã®å·¥å ´å†…åŠ å·¥ãƒ©ã‚¤ãƒ³ã¸ã®ä¾›çµ¦",
      "hourly_rate": 1750.0
    }
  },
  ...
]
```

---

## 5. INTEGRACIÃ“N CON TIMER CARDS

### 5.1 CÃ³mo Timer Cards usan Factory Config

**Flujo actual (PROBLEMA):**
```
Employee has factory_id = "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´"
     â†“
Timer Card gets processed
     â†“
âŒ Overtime calculated using HARDCODED rules
âŒ Break time not validated against factory schedule
âŒ Time rounding not applied
```

**Flujo propuesto (SOLUCIÃ“N):**
```
Employee has factory_id = "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´"
     â†“
Timer Card processor loads factory config
     â†“
âœ… work_hours: "7:00ï½15:30 / 19:00ï½3:30"
âœ… break_time: "11:00ï½11:45 (45åˆ†)"
âœ… overtime_labor: "3h/æ—¥, 42h/æœˆ, 320h/å¹´"
âœ… time_unit: "15.0" (15-minute rounding)
     â†“
Calculate:
- Regular hours = within work_hours
- Overtime hours = exceeding work_hours, capped by overtime_labor
- Break time = validated against break_time
- Round all times to nearest 15 minutes
```

### 5.2 Ejemplo de CÃ¡lculo

**Scenario:**
- Employee: ç”°ä¸­å¤ªéƒ
- Factory: é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´
- Date: 2025-11-13
- Clock In: 6:45
- Clock Out: 18:30
- Break: 11:00-11:45 (45 min)

**Factory Config:**
```json
{
  "schedule": {
    "work_hours": "æ˜¼å‹¤ï¼š7:00ï½15:30 (8.5h including break)",
    "break_time": "11:00ï½11:45 (45åˆ†)",
    "overtime_labor": "3æ™‚é–“/æ—¥, 42æ™‚é–“/æœˆ, 320æ™‚é–“/å¹´",
    "time_unit": "15.0"
  }
}
```

**Calculation with time_unit rounding:**

```
1. Clock In: 6:45 â†’ Round to 7:00 (nearest 15 min)
2. Clock Out: 18:30 â†’ Round to 18:30
3. Total time: 18:30 - 7:00 = 11.5 hours
4. Subtract break: 11.5h - 0.75h = 10.75 hours worked
5. Regular hours: 8.5h (7:00-15:30 minus break)
6. Overtime: 10.75h - 8.5h = 2.25 hours
7. Validate overtime: 2.25h < 3h/day âœ… OK

Result:
- Regular: 8.5h Ã— Â¥1,750 = Â¥14,875
- Overtime: 2.25h Ã— Â¥1,750 Ã— 1.25 = Â¥4,922
- Total: Â¥19,797
```

**Validation against factory rules:**
- âœ… Overtime 2.25h < limit 3h/day
- âœ… Break 45 min matches factory break_time
- âœ… Times rounded to 15-minute intervals

### 5.3 Backend Service para Timer Card Calculation

```python
# backend/app/services/timer_card_calculator.py

class TimerCardCalculator:
    def __init__(self, factory_config: dict):
        self.config = factory_config
        self.schedule = factory_config["schedule"]
        self.time_unit = float(self.schedule.get("time_unit", 15.0))
        
    def round_time(self, time: datetime) -> datetime:
        """Round time to nearest time_unit (default 15 min)"""
        minutes = time.minute
        rounded = round(minutes / self.time_unit) * self.time_unit
        return time.replace(minute=int(rounded), second=0)
    
    def calculate_hours(self, clock_in: datetime, clock_out: datetime) -> dict:
        """Calculate regular and overtime hours"""
        # Round times
        clock_in = self.round_time(clock_in)
        clock_out = self.round_time(clock_out)
        
        # Parse work_hours from config
        work_hours = self.parse_work_hours(self.schedule["work_hours"])
        
        # Parse break_time
        break_minutes = self.parse_break_time(self.schedule["break_time"])
        
        # Calculate total worked
        total_minutes = (clock_out - clock_in).total_seconds() / 60
        total_minutes -= break_minutes  # Subtract break
        
        # Separate regular and overtime
        regular_minutes = min(total_minutes, work_hours * 60)
        overtime_minutes = max(0, total_minutes - work_hours * 60)
        
        # Validate overtime limits
        overtime_limits = self.parse_overtime_limits(self.schedule["overtime_labor"])
        if overtime_minutes / 60 > overtime_limits["daily"]:
            raise ValueError(f"Overtime exceeds daily limit: {overtime_limits['daily']}h")
        
        return {
            "regular_hours": regular_minutes / 60,
            "overtime_hours": overtime_minutes / 60,
            "break_minutes": break_minutes,
            "total_hours": total_minutes / 60,
            "clock_in_rounded": clock_in,
            "clock_out_rounded": clock_out
        }
```

---

## 6. FACTORY CONFIG UI - SCHEDULE EDITOR

### 6.1 Schedule Editor Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ Edit Schedule - æœ¬ç¤¾å·¥å ´                      [âœ• Close]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ğŸ“… Work Hours                                                    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Work Hours Pattern *                                     â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ â—‹ Single Shift                                      â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â— Two Shifts (Day/Night)                            â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ â—‹ Three Shifts (24h)                                â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  Day Shift:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  to  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚ [07:00_]   â”‚  â†’   â”‚ [15:30_]   â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                   â”‚
â”‚  Night Shift:                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  to  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚ [19:00_]   â”‚  â†’   â”‚ [03:30_]   â”‚  (next day)                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  â˜• Break Time                                                    â”‚
â”‚                                                                   â”‚
â”‚  Day Shift Break:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  to  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  =  [45_] minutes            â”‚
â”‚  â”‚ [11:00_]   â”‚  â†’   â”‚ [11:45_]   â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                   â”‚
â”‚  Night Shift Break:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  to  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  =  [45_] minutes            â”‚
â”‚  â”‚ [23:00_]   â”‚  â†’   â”‚ [23:45_]   â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  â±ï¸ Time Rounding                                                 â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Round times to nearest:                                  â”‚    â”‚
â”‚  â”‚ â—‹ 1 minute   â—‹ 5 minutes   â— 15 minutes   â—‹ 30 minutes â”‚    â”‚
â”‚  â”‚ â—‹ 1 hour                                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â„¹ï¸ Example: 6:47 â†’ 6:45  |  6:52 â†’ 6:45  |  6:53 â†’ 7:00       â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  â° Overtime Limits                                               â”‚
â”‚                                                                   â”‚
â”‚  Regular Limits:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  hours/day   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  hours/month              â”‚
â”‚  â”‚ [3___]  â”‚              â”‚ [42__]  â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  hours/year                                         â”‚
â”‚  â”‚ [320_]  â”‚                                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â”‚
â”‚                                                                   â”‚
â”‚  Special Overtime (36å”å®š extension):                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  hours/month   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  hours/year             â”‚
â”‚  â”‚ [80__]  â”‚                â”‚ [720_]  â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  times/year (max applications)                      â”‚
â”‚  â”‚ [6___]  â”‚                                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“† Work Calendar                                                 â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Regular Work Days *                                      â”‚    â”‚
â”‚  â”‚ â˜‘ Mon  â˜‘ Tue  â˜‘ Wed  â˜‘ Thu  â˜‘ Fri  â˜ Sat  â˜ Sun       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Holiday Schedule                                         â”‚    â”‚
â”‚  â”‚ [æœˆï½é‡‘ (ã‚·ãƒ•ãƒˆã«æº–ãšã‚‹)                                 â”‚    â”‚
â”‚  â”‚  åœŸæ—¥ä¼‘ â€¢ å¹´æœ«å¹´å§‹ (12/29-1/5)                          â”‚    â”‚
â”‚  â”‚  GW (4/27-5/4) â€¢ å¤å­£ä¼‘æš‡ (8/10-8/17)__________]        â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Non-work day labor (ä¼‘æ—¥åŠ´åƒ)                            â”‚    â”‚
â”‚  â”‚ [1ãƒ¶æœˆã«2æ—¥ã®ç¯„å›²å†…ã§å‘½ãšã‚‹ã“ã¨ãŒã§ãã‚‹_______]          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                           [Cancel]  [Save Schedule] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. IMPORT/EXPORT SYSTEM

### 7.1 Bulk Import UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¥ Import Factories from JSON                    [âœ• Close]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Select Import Mode:                                              â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â—‹ Single Factory (one JSON file)                        â”‚    â”‚
â”‚  â”‚ â— Multiple Factories (folder with multiple JSON files)  â”‚    â”‚
â”‚  â”‚ â—‹ Full Database Replace (âš ï¸  DANGER: deletes all)      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“ Select Files or Folder:                                       â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ“‚ Drag & drop JSON files here                         â”‚    â”‚
â”‚  â”‚     or                                                   â”‚    â”‚
â”‚  â”‚     [Browse Files...] [Browse Folder...]                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  Selected files:                                                  â”‚
â”‚  âœ… é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´.json                                â”‚
â”‚  âœ… é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_CVJå·¥å ´.json                                 â”‚
â”‚  âœ… åŠ è—¤æœ¨æå·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´.json                            â”‚
â”‚  ... (21 more files)                                              â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  Import Options:                                                  â”‚
â”‚                                                                   â”‚
â”‚  â˜‘ Validate JSON structure before import                         â”‚
â”‚  â˜‘ Skip duplicates (keep existing if factory_id exists)          â”‚
â”‚  â˜ Update existing (overwrite if factory_id exists)              â”‚
â”‚  â˜‘ Create backup before import                                   â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“Š Import Preview:                                               â”‚
â”‚  - 24 files selected                                              â”‚
â”‚  - 14 companies detected                                          â”‚
â”‚  - 24 plants detected                                             â”‚
â”‚  - 150+ lines detected                                            â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     [Cancel]  [Validate & Import] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Export UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¤ Export Factories to JSON                      [âœ• Close]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Select Export Scope:                                             â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â—‹ Single Factory                                         â”‚    â”‚
â”‚  â”‚ â—‹ Single Company (all plants)                           â”‚    â”‚
â”‚  â”‚ â— All Factories (full database)                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  Export Format:                                                   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â— Individual JSON files (one per factory)               â”‚    â”‚
â”‚  â”‚ â—‹ Single JSON file (array of all factories)             â”‚    â”‚
â”‚  â”‚ â—‹ Excel (.xlsx) with multiple sheets                    â”‚    â”‚
â”‚  â”‚ â—‹ CSV files (one per factory)                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  Export Options:                                                  â”‚
â”‚                                                                   â”‚
â”‚  â˜‘ Include schedule data                                         â”‚
â”‚  â˜‘ Include payment data                                          â”‚
â”‚  â˜‘ Include line details                                          â”‚
â”‚  â˜‘ Include responsible persons                                   â”‚
â”‚  â˜ Pretty-print JSON (human-readable, larger file size)          â”‚
â”‚  â˜ Compress to .zip                                              â”‚
â”‚                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                                                                   â”‚
â”‚  ğŸ“Š Export Preview:                                               â”‚
â”‚  - 14 companies                                                   â”‚
â”‚  - 24 plants                                                      â”‚
â”‚  - 150+ lines                                                     â”‚
â”‚  - Estimated size: ~500 KB                                        â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         [Cancel]  [Export & Download] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 JSON Format para Import/Export

**Single Factory Export:**

```json
{
  "factory_id": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´",
  "client_company": {
    "name": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾",
    "address": "æ„›çŸ¥çœŒå¼¥å¯Œå¸‚æ¥ ä¸‰ä¸ç›®13ç•ªåœ°2",
    "phone": "0567-68-8110",
    "responsible_person": {
      "department": "æ„›çŸ¥äº‹æ¥­æ‰€",
      "name": "éƒ¨é•·ã€€å®‰è—¤ã€€å¿",
      "phone": "0567-68-8110"
    },
    "complaint_handler": {
      "department": "äººäº‹åºƒå ±ç®¡ç†éƒ¨",
      "name": "éƒ¨é•·ã€€å±±ç”°ã€€èŒ‚",
      "phone": "0567-68-8110"
    }
  },
  "plant": {
    "name": "æœ¬ç¤¾å·¥å ´",
    "address": "æ„›çŸ¥çœŒå¼¥å¯Œå¸‚æ¥ ä¸‰ä¸ç›®13ç•ªåœ°2",
    "phone": "0567-68-8110"
  },
  "lines": [
    {
      "line_id": "Factory-39",
      "assignment": {
        "department": "ç¬¬ä¸€å–¶æ¥­éƒ¨æœ¬ç¤¾å–¶æ¥­èª²",
        "line": "ãƒªãƒ•ãƒˆä½œæ¥­",
        "supervisor": {
          "department": "",
          "name": "ä¿‚é•·ã€€å‚ä¸Šã€€èˆ",
          "phone": "0567-68-8110"
        }
      },
      "job": {
        "description": "é‹³é€ ææ–™ã®å·¥å ´å†…åŠ å·¥ãƒ©ã‚¤ãƒ³ã¸ã®ä¾›çµ¦",
        "description2": "",
        "hourly_rate": 1750.0
      }
    }
  ],
  "schedule": {
    "work_hours": "æ˜¼å‹¤ï¼š7:00ï½15:30ã€€å¤œå‹¤ï¼š19:00ï½3:30",
    "break_time": "æ˜¼å‹¤ï¼š11:00ï½11:45 å¤œå‹¤ï¼š23:00ï½23:45 (45åˆ†)",
    "calendar": "æœˆï½é‡‘ (ã‚·ãƒ•ãƒˆã«æº–ãšã‚‹) åœŸæ—¥ä¼‘",
    "start_date": "2024-10-01 00:00:00",
    "end_date": "2025-09-30 00:00:00",
    "overtime_labor": "3æ™‚é–“/æ—¥ã€42æ™‚é–“/æœˆã€320æ™‚é–“/å¹´",
    "time_unit": "15.0"
  },
  "payment": {
    "closing_date": "15æ—¥",
    "payment_date": "å½“æœˆæœ«æ—¥",
    "bank_account": "æ„›çŸ¥éŠ€è¡Œã€€å½“çŸ¥æ”¯åº—ã€€æ™®é€š2075479",
    "worker_closing_date": "15æ—¥",
    "worker_payment_date": "15æ—¥",
    "worker_calendar": "åœŸæ—¥ä¼‘ãƒ»å¹´æœ«å¹´å§‹ãƒ»GWãƒ»å¤å­£ä¼‘æš‡"
  },
  "agreement": {
    "period": "2025-03-31 00:00:00",
    "explainer": ""
  }
}
```

**All Factories Export (Array format):**

```json
[
  {
    "factory_id": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_æœ¬ç¤¾å·¥å ´",
    ...
  },
  {
    "factory_id": "é«˜é›„å·¥æ¥­æ ªå¼ä¼šç¤¾_CVJå·¥å ´",
    ...
  },
  ...
]
```

---

## 8. VALIDACIONES Y REGLAS DE NEGOCIO

### 8.1 Validaciones de Datos

**Company Level:**
- âœ… Company name: Required, unique
- âœ… Address: Required, min 10 chars
- âœ… Phone: Required, valid Japanese phone format
- âœ… Responsible person: Name and phone required

**Plant Level:**
- âœ… Plant name: Required
- âœ… factory_id: Auto-generated as `{company_name}_{plant_name}`, unique
- âœ… Address: Required
- âœ… Work hours: Valid time format (HH:MMï½HH:MM)
- âœ… Break time: Must be within work hours
- âœ… Time unit: Must be 1, 5, 15, 30, or 60 minutes
- âœ… Overtime limits: Daily < 6h, Monthly < 80h, Yearly < 720h
- âœ… Closing date: 1-31
- âœ… Payment date: Valid format (å½“æœˆæœ«æ—¥, ç¿ŒæœˆXæ—¥)

**Line Level:**
- âœ… Line ID: Auto-generated, unique across all factories
- âœ… Line name: Required
- âœ… Department: Required
- âœ… Supervisor name: Required
- âœ… Hourly rate: Required, > 0, <= 10000
- âœ… Job description: Required, min 10 chars

### 8.2 Business Rules

**Employee Assignment:**
1. Employee can only be assigned to ONE factory at a time
2. When assigning employee:
   - Must select Company â†’ Plant â†’ Line (cascade)
   - Hourly rate auto-filled from line, but can be overridden
   - Employee's `factory_id` = selected plant's `factory_id`
   - Employee's `hourly_rate` = selected line's `hourly_rate` (default)

**Timer Card Processing:**
1. Load factory config using employee's `factory_id`
2. Round clock in/out times using factory's `time_unit`
3. Validate break time matches factory's `break_time`
4. Calculate regular hours based on factory's `work_hours`
5. Calculate overtime, validate against factory's `overtime_labor` limits
6. If overtime exceeds limits, flag for approval

**Factory Deletion:**
1. Cannot delete factory if employees are assigned to it
2. Must reassign all employees first
3. Show warning with employee count before deletion

**Factory Editing:**
1. Editing schedule affects ALL future timer cards for assigned employees
2. Show warning if employees are currently assigned
3. Log all changes to audit trail

---

## 9. BACKEND IMPLEMENTATION PLAN

### 9.1 Nueva Estructura de Base de Datos

**OpciÃ³n 1: Mantener JSON files + agregar Ã­ndice en DB**

```python
# backend/app/models/models.py

class Factory(Base):
    __tablename__ = "factories"
    
    factory_id = Column(String(200), primary_key=True)  # Company_Plant
    company_name = Column(String(200), nullable=False, index=True)
    plant_name = Column(String(200), nullable=False)
    config_path = Column(String(500))  # Path to JSON file
    line_count = Column(Integer, default=0)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, onupdate=datetime.utcnow)
    
    # Relationships
    employees = relationship("Employee", back_populates="factory")
    timer_cards = relationship("TimerCard", back_populates="factory")
```

**OpciÃ³n 2: Full DB normalization (mÃ¡s complejo pero mÃ¡s robusto)**

```python
class Company(Base):
    __tablename__ = "companies"
    
    id = Column(Integer, primary_key=True)
    name = Column(String(200), unique=True, nullable=False)
    address = Column(String(500))
    phone = Column(String(20))
    responsible_person = Column(JSON)
    complaint_handler = Column(JSON)
    
    plants = relationship("Plant", back_populates="company", cascade="all, delete-orphan")

class Plant(Base):
    __tablename__ = "plants"
    
    id = Column(Integer, primary_key=True)
    factory_id = Column(String(200), unique=True, nullable=False)  # company_plant
    name = Column(String(200), nullable=False)
    company_id = Column(Integer, ForeignKey("companies.id"))
    address = Column(String(500))
    phone = Column(String(20))
    
    # Schedule
    work_hours = Column(String(500))
    break_time = Column(String(200))
    time_unit = Column(Float, default=15.0)
    overtime_labor = Column(String(500))
    calendar = Column(Text)
    
    # Payment
    closing_date = Column(String(20))
    payment_date = Column(String(50))
    bank_account = Column(String(500))
    
    company = relationship("Company", back_populates="plants")
    lines = relationship("Line", back_populates="plant", cascade="all, delete-orphan")
    employees = relationship("Employee", back_populates="plant")

class Line(Base):
    __tablename__ = "lines"
    
    id = Column(Integer, primary_key=True)
    line_id = Column(String(50), unique=True, nullable=False)  # Factory-39
    plant_id = Column(Integer, ForeignKey("plants.id"))
    department = Column(String(200))
    line_name = Column(String(200), nullable=False)
    supervisor = Column(JSON)
    job_description = Column(Text)
    hourly_rate = Column(Float, nullable=False)
    
    plant = relationship("Plant", back_populates="lines")
```

**RecomendaciÃ³n:** Usar **OpciÃ³n 2** (full DB normalization) para mejor integridad de datos.

### 9.2 API Endpoints Nuevos

```python
# backend/app/api/factories.py

from fastapi import APIRouter, Depends, HTTPException, UploadFile
from sqlalchemy.orm import Session
from typing import List

router = APIRouter(prefix="/factories", tags=["factories"])

# ====== COMPANY ENDPOINTS ======

@router.get("/companies", response_model=List[CompanyListResponse])
async def list_companies(db: Session = Depends(get_db)):
    """List all companies with plant/line counts"""
    pass

@router.post("/companies", response_model=CompanyResponse)
async def create_company(company: CompanyCreate, db: Session = Depends(get_db)):
    """Create new company"""
    pass

@router.get("/companies/{company_id}", response_model=CompanyDetailResponse)
async def get_company(company_id: int, db: Session = Depends(get_db)):
    """Get company with all plants and lines"""
    pass

@router.put("/companies/{company_id}", response_model=CompanyResponse)
async def update_company(company_id: int, company: CompanyUpdate, db: Session = Depends(get_db)):
    """Update company info"""
    pass

@router.delete("/companies/{company_id}")
async def delete_company(company_id: int, db: Session = Depends(get_db)):
    """Delete company (must have no employees assigned)"""
    pass

# ====== PLANT ENDPOINTS ======

@router.get("/companies/{company_name}/plants", response_model=List[PlantListResponse])
async def list_plants_by_company(company_name: str, db: Session = Depends(get_db)):
    """List all plants for a company (for cascading dropdown)"""
    pass

@router.post("/plants", response_model=PlantResponse)
async def create_plant(plant: PlantCreate, db: Session = Depends(get_db)):
    """Create new plant"""
    pass

@router.get("/plants/{factory_id}", response_model=PlantDetailResponse)
async def get_plant(factory_id: str, db: Session = Depends(get_db)):
    """Get plant with all lines"""
    pass

@router.put("/plants/{factory_id}", response_model=PlantResponse)
async def update_plant(factory_id: str, plant: PlantUpdate, db: Session = Depends(get_db)):
    """Update plant info and schedule"""
    pass

@router.delete("/plants/{factory_id}")
async def delete_plant(factory_id: str, db: Session = Depends(get_db)):
    """Delete plant (must have no employees assigned)"""
    pass

# ====== LINE ENDPOINTS ======

@router.get("/plants/{factory_id}/lines", response_model=List[LineResponse])
async def list_lines_by_plant(factory_id: str, db: Session = Depends(get_db)):
    """List all lines for a plant (for cascading dropdown)"""
    pass

@router.post("/lines", response_model=LineResponse)
async def create_line(line: LineCreate, db: Session = Depends(get_db)):
    """Create new line"""
    pass

@router.get("/lines/{line_id}", response_model=LineDetailResponse)
async def get_line(line_id: str, db: Session = Depends(get_db)):
    """Get line details"""
    pass

@router.put("/lines/{line_id}", response_model=LineResponse)
async def update_line(line_id: str, line: LineUpdate, db: Session = Depends(get_db)):
    """Update line info"""
    pass

@router.delete("/lines/{line_id}")
async def delete_line(line_id: str, db: Session = Depends(get_db)):
    """Delete line"""
    pass

# ====== IMPORT/EXPORT ENDPOINTS ======

@router.post("/import")
async def import_factories(
    files: List[UploadFile],
    mode: str = "skip_duplicates",  # skip_duplicates | update_existing | replace_all
    db: Session = Depends(get_db)
):
    """Import factories from JSON files"""
    pass

@router.get("/export")
async def export_factories(
    scope: str = "all",  # all | company | single
    company_id: Optional[int] = None,
    factory_id: Optional[str] = None,
    format: str = "json",  # json | json_array | excel | csv
    db: Session = Depends(get_db)
):
    """Export factories to JSON/Excel/CSV"""
    pass

# ====== TREE VIEW ENDPOINT ======

@router.get("/tree", response_model=List[CompanyTreeNode])
async def get_factory_tree(db: Session = Depends(get_db)):
    """Get hierarchical tree: Companies â†’ Plants â†’ Lines"""
    pass
```

### 9.3 Schema Definitions

```python
# backend/app/schemas/factory.py

from pydantic import BaseModel, Field, validator
from typing import List, Optional
from datetime import datetime

# ====== COMPANY SCHEMAS ======

class CompanyBase(BaseModel):
    name: str = Field(..., min_length=2, max_length=200)
    address: str = Field(..., min_length=10)
    phone: str = Field(..., regex=r"^\d{2,4}-\d{2,4}-\d{4}$")
    responsible_person: dict
    complaint_handler: dict

class CompanyCreate(CompanyBase):
    pass

class CompanyUpdate(CompanyBase):
    pass

class CompanyListResponse(BaseModel):
    id: int
    name: str
    address: str
    phone: str
    plant_count: int
    line_count: int
    
    class Config:
        orm_mode = True

class CompanyDetailResponse(CompanyBase):
    id: int
    plants: List["PlantListResponse"]
    created_at: datetime
    updated_at: Optional[datetime]
    
    class Config:
        orm_mode = True

# ====== PLANT SCHEMAS ======

class PlantBase(BaseModel):
    name: str = Field(..., min_length=2, max_length=200)
    company_id: int
    address: str
    phone: str
    work_hours: str
    break_time: str
    time_unit: float = Field(default=15.0, ge=1.0, le=60.0)
    overtime_labor: str
    calendar: str
    closing_date: str
    payment_date: str
    bank_account: Optional[str]

class PlantCreate(PlantBase):
    pass

class PlantUpdate(PlantBase):
    pass

class PlantListResponse(BaseModel):
    id: int
    factory_id: str
    name: str
    address: str
    phone: str
    line_count: int
    
    class Config:
        orm_mode = True

class PlantDetailResponse(PlantBase):
    id: int
    factory_id: str
    lines: List["LineResponse"]
    employee_count: int
    created_at: datetime
    
    class Config:
        orm_mode = True

# ====== LINE SCHEMAS ======

class LineBase(BaseModel):
    plant_id: int
    department: str
    line_name: str = Field(..., min_length=2)
    supervisor: dict
    job_description: str = Field(..., min_length=10)
    hourly_rate: float = Field(..., gt=0, le=10000)

class LineCreate(LineBase):
    pass

class LineUpdate(LineBase):
    pass

class LineResponse(BaseModel):
    id: int
    line_id: str
    plant_id: int
    department: str
    line_name: str
    supervisor: dict
    job_description: str
    hourly_rate: float
    
    class Config:
        orm_mode = True

class LineDetailResponse(LineResponse):
    plant: PlantListResponse
    employee_count: int
    
    class Config:
        orm_mode = True

# ====== TREE VIEW SCHEMAS ======

class LineTreeNode(BaseModel):
    line_id: str
    line_name: str
    department: str
    hourly_rate: float
    supervisor_name: str
    employee_count: int

class PlantTreeNode(BaseModel):
    factory_id: str
    plant_name: str
    address: str
    line_count: int
    employee_count: int
    lines: List[LineTreeNode]

class CompanyTreeNode(BaseModel):
    id: int
    name: str
    address: str
    plant_count: int
    line_count: int
    employee_count: int
    plants: List[PlantTreeNode]
```

---

## 10. FRONTEND IMPLEMENTATION PLAN

### 10.1 Nuevos Componentes

```typescript
// frontend/components/factories/factory-tree.tsx
export function FactoryTree({ companies }: { companies: CompanyTreeNode[] }) {
  // Tree view with expand/collapse
}

// frontend/components/factories/company-form.tsx
export function CompanyForm({ company, onSubmit }: { company?: Company, onSubmit: (data) => void }) {
  // Form for create/edit company
}

// frontend/components/factories/plant-form.tsx
export function PlantForm({ plant, companyId, onSubmit }: { plant?: Plant, companyId: number, onSubmit: (data) => void }) {
  // Form for create/edit plant with schedule editor
}

// frontend/components/factories/line-form.tsx
export function LineForm({ line, plantId, onSubmit }: { line?: Line, plantId: number, onSubmit: (data) => void }) {
  // Form for create/edit line
}

// frontend/components/factories/factory-cascading-select.tsx
export function FactoryCascadingSelect({ 
  onSelect 
}: { 
  onSelect: (company: string, plant: string, line: string, rate: number) => void 
}) {
  // Cascading dropdowns: Company â†’ Plant â†’ Line
  // Auto-fills hourly rate when line selected
}

// frontend/components/factories/schedule-editor.tsx
export function ScheduleEditor({ schedule, onChange }: { schedule: Schedule, onChange: (data) => void }) {
  // Schedule editor with time pickers, overtime limits
}

// frontend/components/factories/import-export-modal.tsx
export function ImportExportModal({ mode }: { mode: 'import' | 'export' }) {
  // Import/export UI with file upload/download
}
```

### 10.2 PÃ¡ginas Nuevas

```typescript
// frontend/app/(dashboard)/factories/page.tsx
export default function FactoriesPage() {
  // Main factory management page with tree view
}

// frontend/app/(dashboard)/factories/companies/[id]/page.tsx
export default function CompanyDetailPage({ params }: { params: { id: string } }) {
  // Company detail page with plants list
}

// frontend/app/(dashboard)/factories/plants/[factory_id]/page.tsx
export default function PlantDetailPage({ params }: { params: { factory_id: string } }) {
  // Plant detail page with lines list and schedule
}

// frontend/app/(dashboard)/employees/[id]/assign-factory/page.tsx
export default function AssignFactoryPage({ params }: { params: { id: string } }) {
  // Employee factory assignment with cascading dropdowns
}
```

### 10.3 API Client Functions

```typescript
// frontend/lib/api/factories.ts

export const factoriesApi = {
  // Companies
  listCompanies: () => api.get<Company[]>('/factories/companies'),
  getCompany: (id: number) => api.get<CompanyDetail>(`/factories/companies/${id}`),
  createCompany: (data: CompanyCreate) => api.post<Company>('/factories/companies', data),
  updateCompany: (id: number, data: CompanyUpdate) => api.put<Company>(`/factories/companies/${id}`, data),
  deleteCompany: (id: number) => api.delete(`/factories/companies/${id}`),
  
  // Plants
  listPlantsByCompany: (companyName: string) => api.get<Plant[]>(`/factories/companies/${companyName}/plants`),
  getPlant: (factoryId: string) => api.get<PlantDetail>(`/factories/plants/${factoryId}`),
  createPlant: (data: PlantCreate) => api.post<Plant>('/factories/plants', data),
  updatePlant: (factoryId: string, data: PlantUpdate) => api.put<Plant>(`/factories/plants/${factoryId}`, data),
  deletePlant: (factoryId: string) => api.delete(`/factories/plants/${factoryId}`),
  
  // Lines
  listLinesByPlant: (factoryId: string) => api.get<Line[]>(`/factories/plants/${factoryId}/lines`),
  getLine: (lineId: string) => api.get<LineDetail>(`/factories/lines/${lineId}`),
  createLine: (data: LineCreate) => api.post<Line>('/factories/lines', data),
  updateLine: (lineId: string, data: LineUpdate) => api.put<Line>(`/factories/lines/${lineId}`, data),
  deleteLine: (lineId: string) => api.delete(`/factories/lines/${lineId}`),
  
  // Tree view
  getFactoryTree: () => api.get<CompanyTreeNode[]>('/factories/tree'),
  
  // Import/Export
  importFactories: (files: FileList, mode: string) => {
    const formData = new FormData()
    Array.from(files).forEach(file => formData.append('files', file))
    formData.append('mode', mode)
    return api.post('/factories/import', formData, {
      headers: { 'Content-Type': 'multipart/form-data' }
    })
  },
  exportFactories: (params: ExportParams) => 
    api.get('/factories/export', { params, responseType: 'blob' })
}
```

---

## 11. MIGRATION PLAN

### 11.1 Migration de JSON a DB

**Script de migraciÃ³n:**

```python
# backend/scripts/migrate_factories_to_db.py

import json
import os
from pathlib import Path
from sqlalchemy.orm import Session
from app.models.models import Company, Plant, Line
from app.core.database import SessionLocal

def migrate_factories():
    db = SessionLocal()
    
    factories_dir = Path("config/factories")
    json_files = list(factories_dir.glob("*.json"))
    
    print(f"Found {len(json_files)} factory JSON files")
    
    # Group by company
    companies_data = {}
    for json_file in json_files:
        if json_file.name == "factory_id_mapping.json":
            continue
        
        with open(json_file, "r", encoding="utf-8") as f:
            factory = json.load(f)
        
        company_name = factory["client_company"]["name"]
        if company_name not in companies_data:
            companies_data[company_name] = {
                "company": factory["client_company"],
                "plants": []
            }
        
        companies_data[company_name]["plants"].append(factory)
    
    print(f"Detected {len(companies_data)} companies")
    
    # Create companies and plants
    for company_name, data in companies_data.items():
        print(f"\nProcessing company: {company_name}")
        
        # Create company
        company = Company(
            name=data["company"]["name"],
            address=data["company"]["address"],
            phone=data["company"]["phone"],
            responsible_person=data["company"]["responsible_person"],
            complaint_handler=data["company"]["complaint_handler"]
        )
        db.add(company)
        db.flush()  # Get company.id
        
        # Create plants
        for plant_data in data["plants"]:
            print(f"  - Plant: {plant_data['plant']['name']}")
            
            plant = Plant(
                factory_id=plant_data["factory_id"],
                name=plant_data["plant"]["name"],
                company_id=company.id,
                address=plant_data["plant"]["address"],
                phone=plant_data["plant"]["phone"],
                work_hours=plant_data["schedule"]["work_hours"],
                break_time=plant_data["schedule"]["break_time"],
                time_unit=float(plant_data["schedule"].get("time_unit", 15.0)),
                overtime_labor=plant_data["schedule"]["overtime_labor"],
                calendar=plant_data["schedule"]["calendar"],
                closing_date=plant_data["payment"]["closing_date"],
                payment_date=plant_data["payment"]["payment_date"],
                bank_account=plant_data["payment"].get("bank_account")
            )
            db.add(plant)
            db.flush()  # Get plant.id
            
            # Create lines
            for line_data in plant_data["lines"]:
                print(f"    â€¢ Line: {line_data['assignment']['line']}")
                
                line = Line(
                    line_id=line_data["line_id"],
                    plant_id=plant.id,
                    department=line_data["assignment"]["department"],
                    line_name=line_data["assignment"]["line"],
                    supervisor=line_data["assignment"]["supervisor"],
                    job_description=line_data["job"]["description"],
                    hourly_rate=float(line_data["job"]["hourly_rate"])
                )
                db.add(line)
    
    db.commit()
    print("\nâœ… Migration completed successfully!")
    print(f"Created {len(companies_data)} companies with {sum(len(c['plants']) for c in companies_data.values())} plants")

if __name__ == "__main__":
    migrate_factories()
```

**Ejecutar migraciÃ³n:**

```bash
# 1. Create new tables
docker exec uns-claudejp-backend bash -c "cd /app && alembic revision --autogenerate -m 'Add factory hierarchy tables'"
docker exec uns-claudejp-backend bash -c "cd /app && alembic upgrade head"

# 2. Run migration script
docker exec uns-claudejp-backend python scripts/migrate_factories_to_db.py

# 3. Verify data
docker exec uns-claudejp-backend python scripts/verify_factories.py
```

### 11.2 Update Employee Model

```python
# backend/app/models/models.py

class Employee(Base):
    __tablename__ = "employees"
    
    id = Column(Integer, primary_key=True)
    # ... existing fields ...
    
    # OLD: factory_id as string
    # factory_id = Column(String(200), ForeignKey("factories.factory_id"))
    
    # NEW: plant_id as foreign key
    plant_id = Column(Integer, ForeignKey("plants.id"))
    line_id = Column(Integer, ForeignKey("lines.id"), nullable=True)
    
    # Relationships
    plant = relationship("Plant", back_populates="employees")
    line = relationship("Line", backref="employees")
    
    @property
    def factory_id(self):
        """Backward compatibility: return plant's factory_id"""
        return self.plant.factory_id if self.plant else None
```

---

## 12. TESTING PLAN

### 12.1 Unit Tests

```python
# backend/tests/test_factories.py

def test_create_company():
    """Test creating a new company"""
    pass

def test_create_plant_with_schedule():
    """Test creating plant with schedule validation"""
    pass

def test_create_line_with_hourly_rate():
    """Test creating line with valid hourly rate"""
    pass

def test_cascading_delete():
    """Test deleting company cascades to plants and lines"""
    pass

def test_prevent_delete_with_employees():
    """Test cannot delete plant with assigned employees"""
    pass

def test_timer_card_uses_factory_schedule():
    """Test timer card calculation uses factory schedule"""
    pass

def test_import_factories_json():
    """Test importing factories from JSON files"""
    pass

def test_export_factories_json():
    """Test exporting factories to JSON"""
    pass
```

### 12.2 Integration Tests

```typescript
// frontend/tests/factories.spec.ts

describe('Factory Management', () => {
  test('should display factory tree', async () => {})
  test('should create new company', async () => {})
  test('should create plant under company', async () => {})
  test('should create line under plant', async () => {})
  test('should edit plant schedule', async () => {})
  test('should delete line', async () => {})
  test('should prevent delete plant with employees', async () => {})
})

describe('Factory Assignment', () => {
  test('should show cascading dropdowns', async () => {})
  test('should load plants when company selected', async () => {})
  test('should load lines when plant selected', async () => {})
  test('should auto-fill hourly rate when line selected', async () => {})
  test('should assign employee to factory', async () => {})
})

describe('Import/Export', () => {
  test('should import JSON files', async () => {})
  test('should export factories to JSON', async () => {})
  test('should validate JSON structure', async () => {})
})
```

---

## 13. DOCUMENTATION TO CREATE

### 13.1 User Documentation

```markdown
# Factory Management User Guide

## 1. Overview
- What is the factory hierarchy?
- How to navigate the factory tree

## 2. Managing Companies
- Creating a new company
- Editing company information
- Deleting a company

## 3. Managing Plants
- Creating a plant under a company
- Editing plant schedule
- Understanding work hours and breaks
- Setting overtime limits

## 4. Managing Lines
- Creating a work line
- Setting hourly rates
- Assigning supervisors

## 5. Assigning Employees
- How to use cascading dropdowns
- Understanding hourly rate auto-fill
- Changing employee assignment

## 6. Import/Export
- Importing factories from JSON
- Exporting factory data
- Bulk operations

## 7. Timer Card Integration
- How factory schedule affects payroll
- Understanding time rounding
- Overtime calculations
```

### 13.2 Developer Documentation

```markdown
# Factory System Developer Guide

## 1. Architecture
- Database schema (Companies â†’ Plants â†’ Lines)
- API endpoints overview
- Frontend components

## 2. Backend Implementation
- Models and relationships
- API routes
- Business logic services
- Validation rules

## 3. Frontend Implementation
- Component tree
- State management
- API integration
- Form handling

## 4. Timer Card Integration
- Factory config loader
- Time calculation logic
- Overtime validation

## 5. Migration Guide
- Migrating from JSON to DB
- Backward compatibility
- Testing migration

## 6. API Reference
- All endpoints with examples
- Request/response schemas
- Error handling
```

---

## 14. IMPLEMENTATION ROADMAP

### Phase 1: Backend Foundation (Week 1)
- âœ… Create database models (Company, Plant, Line)
- âœ… Create Alembic migration
- âœ… Implement basic CRUD endpoints
- âœ… Write migration script from JSON to DB
- âœ… Test migration with real data

### Phase 2: Backend API (Week 2)
- âœ… Implement tree view endpoint
- âœ… Implement cascading dropdown endpoints
- âœ… Add validation rules
- âœ… Add business logic (prevent delete with employees)
- âœ… Write unit tests

### Phase 3: Frontend Components (Week 3)
- âœ… Create factory tree component
- âœ… Create company/plant/line forms
- âœ… Create cascading select component
- âœ… Create schedule editor
- âœ… Style with Tailwind + Shadcn/ui

### Phase 4: Frontend Pages (Week 4)
- âœ… Create /dashboard/factories main page
- âœ… Create company detail page
- âœ… Create plant detail page
- âœ… Create employee assignment page
- âœ… Test all flows

### Phase 5: Import/Export (Week 5)
- âœ… Implement import endpoint
- âœ… Implement export endpoint
- âœ… Create import/export UI
- âœ… Test with real factory JSON files

### Phase 6: Timer Card Integration (Week 6)
- âœ… Update timer card service to load factory config
- âœ… Implement time rounding
- âœ… Implement overtime validation
- âœ… Test with various schedules

### Phase 7: Testing & Documentation (Week 7)
- âœ… Write integration tests
- âœ… Test all edge cases
- âœ… Write user documentation
- âœ… Write developer documentation
- âœ… Create demo video

### Phase 8: Deployment (Week 8)
- âœ… Run migration on production
- âœ… Deploy backend changes
- âœ… Deploy frontend changes
- âœ… Monitor for issues
- âœ… Train users

---

## 15. CONCLUSION

Este diseÃ±o proporciona una soluciÃ³n completa para gestionar la jerarquÃ­a de factories (Company â†’ Plants â†’ Lines) con:

âœ… **UI JerÃ¡rquica:** Tree view colapsable con toda la informaciÃ³n visible
âœ… **Cascading Dropdowns:** SelecciÃ³n intuitiva Company â†’ Plant â†’ Line en asignaciÃ³n de employees
âœ… **Factory Config Editor:** Editor visual para schedule/payment rules
âœ… **Timer Card Integration:** CÃ¡lculos automÃ¡ticos usando factory config
âœ… **Import/Export:** Bulk operations con JSON
âœ… **Validaciones:** Business rules para integridad de datos
âœ… **Full DB Normalization:** Mejor que JSON files para integridad referencial

**PrÃ³ximos pasos:**
1. Review este diseÃ±o con el usuario
2. Aprobar mockups y flujos
3. Comenzar implementaciÃ³n segÃºn roadmap (8 semanas)
4. Iterar basado en feedback

---

**Fin del documento**

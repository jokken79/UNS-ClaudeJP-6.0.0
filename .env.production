# Production Environment Configuration
# UNS-CLAUDEJP 5.4 - Production Security Hardening
# 
# This file contains production environment variables.
# DO NOT commit this file to version control.
# Ensure proper file permissions (600) in production.

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================
UNS_ENVIRONMENT=production
UNS_DEBUG=false
UNS_MAINTENANCE=false
UNS_TIMEZONE=Asia/Tokyo
UNS_LOCALE=ja_JP.UTF-8

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
UNS_SECURITY_LEVEL=high
UNS_ENABLE_AUTH=true
UNS_ENABLE_AUTHZ=true
UNS_ENABLE_INPUT_VALIDATION=true
UNS_ENABLE_AUDIT=true
UNS_ENABLE_ENCRYPTION=true
UNS_ENABLE_RATE_LIMITING=true
UNS_ENABLE_CORS_PROTECTION=true
UNS_ENABLE_CSRF_PROTECTION=true
UNS_ENABLE_SECURITY_HEADERS=true

# Session Management
UNS_SESSION_TIMEOUT=15
UNS_MAX_LOGIN_ATTEMPTS=3
UNS_LOCKOUT_DURATION=30

# Password Policy
UNS_PASSWORD_MIN_LENGTH=12
UNS_PASSWORD_REQUIRE_SPECIAL=true
UNS_PASSWORD_REQUIRE_NUMBERS=true
UNS_PASSWORD_REQUIRE_UPPERCASE=true
UNS_PASSWORD_REQUIRE_LOWERCASE=true
UNS_ENABLE_2FA=true

# =============================================================================
# DATABASE SETTINGS
# =============================================================================
# Database Connection (REQUIRED - replace with actual values)
DATABASE_URL=CHANGE_THIS_TO_ACTUAL_DATABASE_URL

# Database Pool Configuration
UNS_DB_POOL_SIZE=20
UNS_DB_TIMEOUT=30
UNS_DB_QUERY_LOGGING=false
UNS_DB_BACKUP=true

# Database SSL Configuration
UNS_DB_SSL_ENABLED=true
UNS_DB_SSL_CERT_PATH=/path/to/ssl/cert.pem
UNS_DB_SSL_KEY_PATH=/path/to/ssl/key.pem
UNS_DB_SSL_CA_PATH=/path/to/ssl/ca.pem

# =============================================================================
# CREDENTIAL MANAGEMENT
# =============================================================================
# Master encryption key (REQUIRED - generate with: python -c 'import secrets; print(secrets.token_urlsafe(64))')
UNS_CLAUDEJP_MASTER_KEY=CHANGE_THIS_TO_SECURE_RANDOM_KEY

# Database Credential Storage
UNS_CLAUDEJP_DB_MASTER_KEY=CHANGE_THIS_TO_SECURE_RANDOM_KEY

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================
UNS_ENABLE_CACHE=true
UNS_CACHE_TTL=7200
UNS_MAX_CONNECTIONS=200
UNS_MAX_WORKERS=4
UNS_MEMORY_LIMIT=2048
UNS_CPU_LIMIT=80.0

# =============================================================================
# LOGGING SETTINGS
# =============================================================================
UNS_LOG_LEVEL=WARNING
UNS_LOG_FILE=true
UNS_LOG_CONSOLE=true
UNS_LOG_STRUCTURED=true
UNS_LOG_ROTATION_MB=100
UNS_LOG_RETENTION_DAYS=90
UNS_LOG_COMPRESSION=true

# Log Directories
UNS_LOG_DIRECTORY=./logs
UNS_AUDIT_LOG_DIRECTORY=./audit_logs
UNS_ERROR_LOG_DIRECTORY=./error_logs
UNS_ACCESS_LOG_DIRECTORY=./access_logs

# Log Shipping (Optional)
UNS_LOG_SHIPPING=false
UNS_LOG_SHIPPING_ENDPOINT=https://your-log-aggregator.com/api/logs
UNS_LOG_SHIPPING_FORMAT=json

# =============================================================================
# MONITORING SETTINGS
# =============================================================================
UNS_HEALTH_CHECKS=true
UNS_HEALTH_CHECK_INTERVAL=30
UNS_METRICS=true
UNS_METRICS_INTERVAL=60
UNS_ALERTS=true

# Alert Recipients (comma-separated)
UNS_ALERT_EMAIL_RECIPIENTS=security@uns-kikaku.com,ops@uns-kikaku.com
UNS_ALERT_WEBHOOK_URLS=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# Dashboard Configuration
UNS_DASHBOARD=true
UNS_DASHBOARD_PORT=8080
UNS_DASHBOARD_HOST=127.0.0.1

# Prometheus Configuration
UNS_PROMETHEUS=true
UNS_PROMETHEUS_PORT=9090

# Grafana Configuration
UNS_GRAFANA=true
UNS_GRAFANA_PORT=3000

# =============================================================================
# BACKUP SETTINGS
# =============================================================================
UNS_AUTO_BACKUP=true
UNS_BACKUP_INTERVAL=6
UNS_BACKUP_RETENTION=30
UNS_BACKUP_DIRECTORY=./backups
UNS_BACKUP_ENCRYPTION=true
UNS_BACKUP_COMPRESSION=true

# Offsite Backup (Optional)
UNS_OFFSITE_BACKUP=false
UNS_OFFSITE_BACKUP_ENDPOINT=s3://your-backup-bucket
UNS_OFFSITE_BACKUP_CREDENTIALS=CHANGE_THIS_TO_BACKUP_CREDENTIALS

# =============================================================================
# PHOTO EXTRACTION SETTINGS
# =============================================================================
PHOTO_EXTRACTION_METHOD=auto
PHOTO_CHUNK_SIZE=1000
PHOTO_MAX_WORKERS=8
PHOTO_ENABLE_CACHE=true
PHOTO_LOG_LEVEL=WARNING
PHOTO_FORCE_REGENERATE=false
PHOTO_DRY_RUN=false

# Photo Extraction Security
PHOTO_ENABLE_VALIDATION=true
PHOTO_ENABLE_INTEGRITY_CHECK=true
PHOTO_ENABLE_ENCRYPTION=true
PHOTO_MAX_PHOTO_SIZE_MB=10
PHOTO_SECURE_DELETION=true

# =============================================================================
# API SECURITY SETTINGS
# =============================================================================
# JWT Configuration
SECRET_KEY=CHANGE_THIS_TO_SECURE_RANDOM_JWT_SECRET_KEY
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=480
REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_AUDIENCE=uns-claudejp::api
JWT_ISSUER=uns-claudejp

# Cookie Security
COOKIE_SECURE=true
COOKIE_HTTPONLY=true
COOKIE_SAMESITE=lax
COOKIE_DOMAIN=.uns-kikaku.com

# CORS Configuration
BACKEND_CORS_ORIGINS=https://uns-kikaku.com,https://app.uns-kikaku.com
ADDITIONAL_TRUSTED_HOSTS=uns-kikaku.com,app.uns-kikaku.com

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_GLOBAL=100/minute
RATE_LIMIT_AUTH_LOGIN=3/minute
RATE_LIMIT_AUTH_REGISTER=1/hour
RATE_LIMIT_AUTH_REFRESH=10/minute
RATE_LIMIT_UPLOAD=5/minute
RATE_LIMIT_SENSITIVE=10/minute
RATE_LIMIT_READ=50/minute

# =============================================================================
# OCR AND EXTERNAL SERVICES
# =============================================================================
# Gemini API (Primary OCR)
GEMINI_API_KEY=CHANGE_THIS_TO_GEMINI_API_KEY

# Google Cloud Vision API (Backup OCR)
GOOGLE_CLOUD_VISION_ENABLED=false
GOOGLE_CLOUD_VISION_API_KEY=CHANGE_THIS_TO_GC_VISION_API_KEY
GOOGLE_APPLICATION_CREDENTIALS=/path/to/gcp/credentials.json

# Azure Computer Vision API
AZURE_COMPUTER_VISION_ENDPOINT=https://your-region.api.cognitive.microsoft.com/
AZURE_COMPUTER_VISION_KEY=CHANGE_THIS_TO_AZURE_VISION_KEY
AZURE_COMPUTER_VISION_API_VERSION=2023-02-01-preview

# =============================================================================
# TELEMETRY AND OBSERVABILITY
# =============================================================================
UNS_ENABLE_TELEMETRY=true
OTEL_SERVICE_NAME=uns-claudejp-backend
OTEL_EXPORTER_OTLP_ENDPOINT=https://your-otel-collector:4317
OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=https://your-otel-collector:4317
OTEL_METRICS_EXPORT_INTERVAL_MS=60000
PROMETHEUS_METRICS_PATH=/metrics

# =============================================================================
# EMAIL NOTIFICATIONS
# =============================================================================
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=CHANGE_THIS_TO_SMTP_USER
SMTP_PASSWORD=CHANGE_THIS_TO_SMTP_PASSWORD
SMTP_FROM=noreply@uns-kikaku.com

# LINE Notifications (Optional)
LINE_CHANNEL_ACCESS_TOKEN=CHANGE_THIS_TO_LINE_ACCESS_TOKEN

# WhatsApp Notifications (Optional)
WHATSAPP_ENABLED=false
WHATSAPP_TOKEN=CHANGE_THIS_TO_WHATSAPP_TOKEN
WHATSAPP_PHONE_ID=CHANGE_THIS_TO_WHATSAPP_PHONE_ID

# =============================================================================
# FILE UPLOAD SECURITY
# =============================================================================
MAX_UPLOAD_SIZE=10485760
ALLOWED_EXTENSIONS=pdf,jpg,jpeg,png,xlsx,xls
UPLOAD_DIR=/app/uploads

# =============================================================================
# REDIS CACHE (Optional)
# =============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=CHANGE_THIS_TO_REDIS_PASSWORD

# =============================================================================
# COMPLIANCE AND AUDIT
# =============================================================================
# GDPR Compliance
GDPR_COMPLIANCE=true
DATA_PROTECTION_OFFICER=privacy@uns-kikaku.com
BREACH_NOTIFICATION_EMAIL=security@uns-kikaku.com

# Audit Configuration
AUDIT_RETENTION_DAYS=2555
AUDIT_INTEGRITY_CHECK=true
AUDIT_ENCRYPTION=true
AUDIT_REAL_TIME_MONITORING=true

# =============================================================================
# INCIDENT RESPONSE
# =============================================================================
INCIDENT_RESPONSE_TEAM=security@uns-kikaku.com,ops@uns-kikaku.com,legal@uns-kikaku.com
INCIDENT_RESPONSE_ESCALATION=true
REGULATORY_REPORTING_TIMEFRAME=72

# =============================================================================
# DEVELOPMENT OVERRIDES (DISABLE IN PRODUCTION)
# =============================================================================
# The following settings should be commented out or set to false in production
# DEBUG_SQL=false
# DEBUG_REQUESTS=false
# DEBUG_RESPONSES=false
# ENABLE_PROFILING=false
# ENABLE_DEBUG_ROUTES=false

# =============================================================================
# DEPLOYMENT SPECIFIC
# =============================================================================
# Docker Configuration
COMPOSE_PROJECT_NAME=uns-claudejp-prod
COMPOSE_FILE=docker-compose.prod.yml

# Kubernetes Configuration
KUBERNETES_NAMESPACE=uns-claudejp-prod
KUBERNETES_CONFIG_FILE=k8s-production.yaml

# Blue-Green Deployment
BLUE_GREEN_DEPLOYMENT=true
DEPLOYMENT_STRATEGY=rolling
HEALTH_CHECK_GRACE_PERIOD=30
ROLLBACK_ON_FAILURE=true

# =============================================================================
# SECURITY HARDENING
# =============================================================================
# System Hardening
DISABLE_ROOT_ACCESS=true
DISABLE_SSH_PASSWORD_AUTH=true
ENABLE_FAIL2BAN=true
ENABLE_APPARMOR=true
ENABLE_SELINUX=true

# Network Security
FIREWALL_ENABLED=true
INTRUSION_DETECTION=true
DDOS_PROTECTION=true
VPN_REQUIRED=true

# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
# 1. All CHANGE_THIS values are replaced with actual secure values
# 2. File permissions are set to 600 for sensitive files
# 3. SSL certificates are valid and properly configured
# 4. Database connections use SSL/TLS
# 5. All passwords are strong and unique
# 6. 2FA is enabled for all admin accounts
# 7. Backup procedures are tested and verified
# 8. Monitoring and alerting are configured and tested
# 9. Security policies are reviewed and approved
# 10. Compliance requirements are met
# 11. Incident response procedures are documented and tested
# 12. Log retention policies comply with regulations
# 13. Rate limiting is configured and tested
# 14. CORS policies are restrictive and appropriate
# 15. All debug features are disabled
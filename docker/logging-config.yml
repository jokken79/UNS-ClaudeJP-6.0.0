# ========================================
# UNS-ClaudeJP 5.4.1 - Docker Logging Configuration
# ========================================
#
# Purpose: Centralized logging configuration for all services
# Format: JSON structured logs
# Rotation: 10MB per file, 3 files max
# Driver: json-file (default)
#
# Author: Claude Code
# Created: 2025-11-12
# Version: 1.0.0
#
# ========================================
#
# This configuration is used as x-logging anchor in docker-compose.yml
# and can be referenced by all services for consistent logging.
#
# Benefits:
# - Prevents disk space issues from unbounded logs
# - Structured JSON format for log aggregation
# - Ready for ELK stack integration
# - Easy to parse and analyze
#
# Log Location:
# - Linux: /var/lib/docker/containers/<container-id>/<container-id>-json.log
# - Windows: C:\ProgramData\Docker\containers\<container-id>\<container-id>-json.log
#
# ========================================

# Default logging configuration (used by most services)
x-logging-default: &logging-default
  driver: json-file
  options:
    max-size: "10m"
    max-file: "3"
    compress: "true"
    labels: "service,environment"
    tag: "{{.Name}}/{{.ID}}"

# Verbose logging (for debugging services)
x-logging-verbose: &logging-verbose
  driver: json-file
  options:
    max-size: "20m"
    max-file: "5"
    compress: "true"
    labels: "service,environment"
    tag: "{{.Name}}/{{.ID}}"

# Minimal logging (for low-activity services)
x-logging-minimal: &logging-minimal
  driver: json-file
  options:
    max-size: "5m"
    max-file: "2"
    compress: "true"
    labels: "service,environment"
    tag: "{{.Name}}/{{.ID}}"

# ELK Stack Ready (commented - uncomment to enable)
# Requires ELK stack running and accessible
x-logging-elk: &logging-elk
  driver: json-file
  # Uncomment below to send to ELK stack
  # driver: gelf
  # options:
  #   gelf-address: "udp://elk-host:12201"
  #   tag: "{{.Name}}/{{.ID}}"
  #   labels: "service,environment"
  #   env: "LOG_LEVEL,ENVIRONMENT"

# Syslog (for enterprise environments)
x-logging-syslog: &logging-syslog
  driver: json-file
  # Uncomment below to send to syslog
  # driver: syslog
  # options:
  #   syslog-address: "tcp://syslog-server:514"
  #   tag: "{{.Name}}/{{.ID}}"
  #   syslog-format: "rfc5424"

# Fluentd (for log aggregation)
x-logging-fluentd: &logging-fluentd
  driver: json-file
  # Uncomment below to send to Fluentd
  # driver: fluentd
  # options:
  #   fluentd-address: "fluentd:24224"
  #   tag: "docker.{{.Name}}"
  #   fluentd-async: "true"
  #   fluentd-buffer-limit: "1m"

# ========================================
# Service-Specific Logging Recommendations
# ========================================
#
# backend:           logging-verbose (high activity, needs debugging)
# frontend:          logging-verbose (high activity, needs debugging)
# db:                logging-default (moderate activity)
# redis:             logging-minimal (low activity, cache)
# nginx:             logging-verbose (high activity, access logs)
# grafana:           logging-default (moderate activity)
# prometheus:        logging-default (moderate activity)
# tempo:             logging-default (moderate activity)
# otel-collector:    logging-verbose (telemetry data)
# backup:            logging-default (scheduled activity)
# adminer:           logging-minimal (low activity, dev only)
#
# ========================================
